<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cross-Section Module Tutorial: Spectral Line Shapes · Radiative Transfer</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Radiative Transfer</span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../CrossSection/">CrossSection</a></li><li><a class="tocitem" href="../../PhaseFunction/">PhaseFunction</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Cross-Section Module Tutorial: Spectral Line Shapes</a></li><li><a class="tocitem" href="../Tutorial_PhaseFunction/">Simple Mie Phase Function Tutorial</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Cross-Section Module Tutorial: Spectral Line Shapes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cross-Section Module Tutorial: Spectral Line Shapes</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/RupeshJey/RadiativeTransfer.jl/blob/master/docs/src/pages/tutorials/Tutorial_CrossSection.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Cross-Section-Module-Tutorial:-Spectral-Line-Shapes"><a class="docs-heading-anchor" href="#Cross-Section-Module-Tutorial:-Spectral-Line-Shapes">Cross-Section Module Tutorial: Spectral Line Shapes</a><a id="Cross-Section-Module-Tutorial:-Spectral-Line-Shapes-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-Section-Module-Tutorial:-Spectral-Line-Shapes" title="Permalink"></a></h1><p>Part of ESE 156 Remote Sensing Class; 2020; Christian Frankenberg</p><p>The purpose of this tutorial is to learn how to compute line-shapes (in our case mostly of rotational-vibrational transition lines), what processes determine line-shapes and how the dependencies in the line-shape on pressure and temperature could actually be used to our advantage in a retrieval system.</p><h3 id="Basic-Tools"><a class="docs-heading-anchor" href="#Basic-Tools">Basic Tools</a><a id="Basic-Tools-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Tools" title="Permalink"></a></h3><p>We are making use of the <a href="https://www.cfa.harvard.edu/hitran/">HITRAN database</a>, see a list of tutorials <a href="https://www.youtube.com/playlist?list=PLqOG3cBizTUFQw5lwpkCpQFCVuxHTZgrT">here</a></p><p>There are other spectroscopic linelists but we are focusing on HITRAN only here. In addition, there are more complex line-shapes that we are not treating here, including <a href="https://journals.aps.org/pr/abstract/10.1103/PhysRev.89.472">collisional narrowing</a>, <a href="https://aip.scitation.org/doi/abs/10.1063/1.478724">line-mixing</a>, <a href="https://www.sciencedirect.com/science/article/abs/pii/S0022407311003773">collision-induced absorption (CIA)</a>.</p><h3 id="Line-shape-(background-covered-in-class):"><a class="docs-heading-anchor" href="#Line-shape-(background-covered-in-class):">Line-shape (background covered in class):</a><a id="Line-shape-(background-covered-in-class):-1"></a><a class="docs-heading-anchor-permalink" href="#Line-shape-(background-covered-in-class):" title="Permalink"></a></h3><p>If we have a line-strength S (in cm<span>$^{-1}$</span> cm<span>$^2$</span>/molecule) for a specific transition at <span>$\nu_0$</span>, we can compute the cross section as:</p><div>\[\sigma(\nu) = S\Phi(\nu-\nu_0)\,,\]</div><p>where <span>$\Phi(\nu-\nu_0)$</span> denotes the line-shape function (in 1/cm<span>$^{-1}$</span>), which is normalized to 1:</p><div>\[\int_{-\infty}^\infty \Phi(\nu-\nu_0) d\nu=1\]</div><p>There are several processes that affect the shape and width of <span>$\Phi$</span> and we will walk through the most important ones here now.</p><h5 id="Doppler-Broadening"><a class="docs-heading-anchor" href="#Doppler-Broadening">Doppler Broadening</a><a id="Doppler-Broadening-1"></a><a class="docs-heading-anchor-permalink" href="#Doppler-Broadening" title="Permalink"></a></h5><p>Doppler broadening is caused by a simple doppler shift of emitted and absorbed frequencies, caused by the relative velocities of the molecules along the line of sight. A doppler shifted apparent frequency from the centroid frequency <span>$\nu_0$</span> can be described as:</p><div>\[\nu = \nu_0\left(1+\frac{v_r}{c}\right)\,\]</div><p>where <span>$v_r$</span> is the relative velocity of the absorbing photon along the line of sight. The doppler shift is then simply</p><div>\[\Delta\nu = \nu_0\frac{v_r}{c}\]</div><p>Let us take a simple example with the satellite flying at 7km/s and either staring into the flight direction (technically, it wouldn&#39;t see the atmosphere then but let&#39;s ignore this) or looking into the back:</p><p>____</p><pre><code class="language-julia"># Speed of light (in m/s)
c = 299792458.0

# Relative velocity (in m/s)
vᵣ = 7000.0

# Center wavenumber (say 1600nm, which is 1e7/1600=6250 cm$^{-1}$)
v₀ = 6250.0

# Doppler shift:
Δ_ν = ( v₀ * vᵣ) / c

# Just writing out doppler shift in wavenumbers and wavelengths
println(&quot;Doppler shift = $Δ_ν cm-1&quot;)
println(&quot;Doppler shift = $(1e7/(v₀-Δ_ν)-1e7/v₀) nm&quot;)</code></pre><pre class="documenter-example-output">Doppler shift = 0.14593429164919153 cm-1
Doppler shift = 0.03736005100040529 nm</pre><h4 id="Random-movements-of-molecules-in-gases-lead-to-doppler-broadening-effects"><a class="docs-heading-anchor" href="#Random-movements-of-molecules-in-gases-lead-to-doppler-broadening-effects">Random movements of molecules in gases lead to doppler broadening effects</a><a id="Random-movements-of-molecules-in-gases-lead-to-doppler-broadening-effects-1"></a><a class="docs-heading-anchor-permalink" href="#Random-movements-of-molecules-in-gases-lead-to-doppler-broadening-effects" title="Permalink"></a></h4><p>In the one-dimensional case along say the x-axis (we only observe the distribution along one line of sight), the speed of molecules is distributed according to the Maxwell-Boltzmann distribution:</p><div>\[f(v_x) = \sqrt{\frac{m}{2\pi kT}}\exp{\left(-\frac{mv_x^2}{2kT}\right)}.\]</div><p>We can then define a Doppler width <span>$\Delta \nu_D$</span> as</p><div>\[\Delta \nu_D = \frac{\nu_0}{c}\sqrt{\frac{2kT}{m}}= \frac{\nu_0}{c}\sqrt{\frac{2RT}{M}}\,\]</div><p>which yields the following line-shape:</p><div>\[\phi_D(\nu) = \frac{1}{\Delta \nu_D \sqrt{\pi}}\exp{\left(-\frac{(\nu-\nu_0)^2}{\Delta \nu^2_D}\right)}=\,,\]</div><p>which is a Gaussian distribution.</p><p>Let us put in some numbers with R=8.3144598 J/K/mol at 6000cm<span>$^{-1}$</span>:</p><p>&lt;li&gt;T = 220K, 290K</p><p>&lt;li&gt;M = 16g/mol (CH<span>$4$</span>) or 44g/mol (CO<span>$_2$</span>)</p><hr/><div>\[\Delta \nu_D(290K,CO_2)=0.0066cm^{-1}\]</div><div>\[\Delta \nu_D(220K,CO_2)=0.0058cm^{-1}\]</div><div>\[\Delta \nu_D(290K,CH_4)=0.0110cm^{-1}\]</div><div>\[\Delta \nu_D(290K,CH_4)=0.0096cm^{-1}\]</div><p>Multitply with about 1.6585 (2<span>$\sqrt{ln(2)}$</span>) to get FWHM</p><hr/><h3 id="Natural-and-collisional-broadening"><a class="docs-heading-anchor" href="#Natural-and-collisional-broadening">Natural and collisional broadening</a><a id="Natural-and-collisional-broadening-1"></a><a class="docs-heading-anchor-permalink" href="#Natural-and-collisional-broadening" title="Permalink"></a></h3><p>Due to the Heisenberg principle</p><div>\[\Delta E \Delta t \sim h/2\pi\,,\]</div><p>As <span>$\Delta E$</span> is <span>$h\Delta\nu$</span>, we can write:</p><div>\[\Delta\nu = \frac{h/2\pi}{\tau}\]</div><p>The natural line-width is defined by using the radiative lifetime but this is mostly negligible as the natural lifetime of the upper state is usually much much smaller than the &quot;perturbed&quot; lifetime in the presence of quencher (e.g. through collisions). Again, there are exceptions.</p><p>Collisions between molecules reduce the lifetime of the upper state, thus widening the line width. This behavor gives rise to the so-called Lorentz lineshape.</p><div>\[\phi_L(\nu) = \frac{\alpha_L}{\pi \left[(\nu-\nu_0)^2+\alpha_L^2\right]}\]</div><p><span>$\alpha_L$</span> depends linearly on the number density of the perturbing molecules and the relative speed of the collision partners (thus scales linearly with pressure and with <span>$\sqrt{T}$</span>, basically both density and velocity affect the number of collisions per time).</p><hr/><h3 id="Voigt-lineshape"><a class="docs-heading-anchor" href="#Voigt-lineshape">Voigt lineshape</a><a id="Voigt-lineshape-1"></a><a class="docs-heading-anchor-permalink" href="#Voigt-lineshape" title="Permalink"></a></h3><p>The Voigt line-shape is the combination of Doppler and Pressure broadening (convolution of the two) but cannot be evaluated analytically. However, there are numerical routines to compute it efficiently.</p><hr/><h3 id="Other-more-complex-lineshapes"><a class="docs-heading-anchor" href="#Other-more-complex-lineshapes">Other more complex lineshapes</a><a id="Other-more-complex-lineshapes-1"></a><a class="docs-heading-anchor-permalink" href="#Other-more-complex-lineshapes" title="Permalink"></a></h3><p>Once you dig deeper, there are various other more complex line-shapes (and line-mixing effects), which we ignore for now as the Voigt line-shape can provide very reasonable results. See, for instance, <a href="https://www.degruyter.com/view/j/pac.2014.86.issue-12/pac-2014-0208/pac-2014-0208.xml">here</a></p><pre><code class="language-">using Plots
using Pkg.Artifacts
using FTPClient
using RadiativeTransfer
using RadiativeTransfer.CrossSection
using LaTeXStrings</code></pre><h3 id="Please-download-ftp://fluo.gps.caltech.edu/XYZT*hitran/hitran*molec*id*2_CO2.par-into-your-files-folder"><a class="docs-heading-anchor" href="#Please-download-ftp://fluo.gps.caltech.edu/XYZT*hitran/hitran*molec*id*2_CO2.par-into-your-files-folder">Please download ftp://fluo.gps.caltech.edu/XYZT<em>hitran/hitran</em>molec<em>id</em>2_CO2.par into your files folder</a><a id="Please-download-ftp://fluo.gps.caltech.edu/XYZT*hitran/hitran*molec*id*2_CO2.par-into-your-files-folder-1"></a><a class="docs-heading-anchor-permalink" href="#Please-download-ftp://fluo.gps.caltech.edu/XYZT*hitran/hitran*molec*id*2_CO2.par-into-your-files-folder" title="Permalink"></a></h3><p>In the future, this will become obsolete (downloads should be automatic) but we are still fixing these things. If you are wondering abut molecule and isotope IDs, they are defined for HITRAN <a href="https://hitran.org/docs/molec-meta/">here</a> and <a href="https://hitran.org/docs/iso-meta/">here</a></p><pre><code class="language-">ftp = FTP(&quot;ftp://fluo.gps.caltech.edu/XYZT_hitran/&quot;)
download(ftp, &quot;hitran_molec_id_2_CO2.par&quot;, &quot;hitran_molec_id_2_CO2.par&quot;);
co2_par = CrossSection.read_hitran(&quot;hitran_molec_id_2_CO2.par&quot;, mol=2, iso=1, ν_min=6214.4, ν_max=6214.8);
line_voigt   = make_hitran_model(co2_par, Voigt())
line_doppler = make_hitran_model(co2_par, Doppler())
line_lorentz = make_hitran_model(co2_par, Lorentz())
# Specify our wavenumber grid
ν = 6210:0.001:6220;
nothing #hide</code></pre><pre><code class="language-">cs_co2_1atm   = absorption_cross_section(line_voigt, ν, 1013.0     , 296.0);
cs_co2_075atm = absorption_cross_section(line_voigt, ν, 0.75*1013.0, 296.0);
cs_co2_05atm  = absorption_cross_section(line_voigt, ν, 0.5*1013.0 , 296.0);
cs_co2_025atm = absorption_cross_section(line_voigt, ν, 0.25*1013.0, 296.0);
cs_co2_01atm  = absorption_cross_section(line_voigt, ν, 0.1*1013.0 , 296.0);

#Get some more line-shapes just for Doppler and Voigt
cs_co2_01atm    = absorption_cross_section(line_voigt,   ν, 0.1*1013.0 , 296.0);
cs_co2_doppler  = absorption_cross_section(line_doppler, ν, 0.1*1013.0 , 296.0);
cs_co2_lorentz  = absorption_cross_section(line_lorentz, ν, 0.1*1013.0 , 296.0);
nothing #hide</code></pre><pre><code class="language-">#plotly()
ff = 1e20;
plot(ν,  ff*cs_co2_1atm,   label=&quot;Voigt, 1atm&quot;, yformatter = :scientific)
plot!(ν, ff*cs_co2_075atm, label=&quot;Voigt, 0.75atm&quot;)
plot!(ν, ff*cs_co2_05atm,  label=&quot;Voigt, 0.5atm&quot;)
plot!(ν, ff*cs_co2_025atm, label=&quot;Voigt, 0.25atm&quot;)

xlims!((6214,6215.2))
xlabel!(&quot;Wavenumber (cm⁻¹))&quot;)</code></pre><pre><code class="language-">plot( ν, cs_co2_01atm   /maximum(cs_co2_01atm) ,label=&quot;Voigt, 296K, 0.1atm&quot;)
plot!(ν, cs_co2_doppler /maximum(cs_co2_01atm) ,label=&quot;Doppler, 296K&quot;)
plot!(ν, cs_co2_lorentz /maximum(cs_co2_01atm) ,label=&quot;Lorentz, 296K, 0.1atm&quot;)
xlims!((6214.4,6214.8))

ylabel!(&quot;σ/max(σ)&quot;)
xlabel!(&quot;Wavenumber (cm⁻¹)&quot;)</code></pre><h3 id="From-an-individual-line-to-a-band"><a class="docs-heading-anchor" href="#From-an-individual-line-to-a-band">From an individual line to a band</a><a id="From-an-individual-line-to-a-band-1"></a><a class="docs-heading-anchor-permalink" href="#From-an-individual-line-to-a-band" title="Permalink"></a></h3><p>Here, we will just compute an entire band of CO<span>$_2$</span> (a few to be precise) and look at some simple behavior, e.g. the re-distribution of individual lines in the P and R branch with changing temperature.</p><pre><code class="language-">co2_par_band = CrossSection.read_hitran(&quot;hitran_molec_id_2_CO2.par&quot;, mol=2, iso=1, ν_min=6000.0, ν_max=6400.0);
band_voigt   = make_hitran_model(co2_par_band , Voigt())</code></pre><pre><code class="language-">ν_band = 6300:0.01:6400;
σ_co2_Voigt220 = absorption_cross_section(band_voigt, ν_band, 1013.0 , 220.0);
σ_co2_Voigt290 = absorption_cross_section(band_voigt, ν_band, 1013.0 , 290.0);
nothing #hide</code></pre><pre><code class="language-">plot( ν_band, ff*σ_co2_Voigt220, alpha=0.5, label=&quot;220K&quot;)
plot!(ν_band, ff*σ_co2_Voigt290, alpha=0.5, label=&quot;290K&quot;)
xlims!((6300,6380))</code></pre><pre><code class="language-">plot(ν_band, ff*(σ_co2_Voigt220 - σ_co2_Voigt290), label=&quot;220K-290K&quot;)
xlims!((6300,6380))</code></pre><p>Think about this temperature dependence!! &lt;li&gt; Why is it there? &lt;li&gt; Can you see the P and R branch? &lt;li&gt; Can you identify different J levels?</p><hr/><h3 id="Some-fun-stuff"><a class="docs-heading-anchor" href="#Some-fun-stuff">Some fun stuff</a><a id="Some-fun-stuff-1"></a><a class="docs-heading-anchor-permalink" href="#Some-fun-stuff" title="Permalink"></a></h3><pre><code class="language-">T = 290.0
@gif for p = 10:10:1100
    σ = absorption_cross_section(band_voigt, ν_band, p , T);
    plot(ν_band, ff*σ, yaxis=:log,label=&quot;p=$p&quot;)
    ylims!((1e-7, 1e-1))
end</code></pre><pre><code class="language-">p = 900.0
@gif for T = 10:10:320
    σ = absorption_cross_section(band_voigt, ν_band, p , T);
    plot(ν_band, ff*σ, yaxis=:log, label=&quot;T=$T&quot;)
    ylims!((1e-7, 1e-1))
end</code></pre><pre><code class="language-"># More extreme case, let&#39;s take 10 atmospheres (10,000hPa)
σ = absorption_cross_section(band_voigt, ν_band, 10000.0 , 300.0);
plot(ν_band, ff*σ, label=&quot;p=10000.0hPa&quot;)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../PhaseFunction/">« PhaseFunction</a><a class="docs-footer-nextpage" href="../Tutorial_PhaseFunction/">Simple Mie Phase Function Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 13 October 2020 00:07">Tuesday 13 October 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
